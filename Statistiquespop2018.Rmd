---
title: "Statistiques population cible 2018"
output:
  word_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```


```{r}
library(tidyverse)
```

**DONNEES**

**Population totale**


```{r}
setwd("~/Documents/2A/Statapp/données")
library(readr)
nat2018us <- read_csv("W:/Documents/2A/Statapp/données/nat2018us.csv", col_types = cols_only(apgar5r = col_guess(), 
                                                           dbwt = col_guess(),
                                                           rf_inftr = col_guess(),
                                                           rf_fedrg = col_guess(),
                                                           rf_artec = col_guess(),
                                                           mager = col_guess(),
                                                           mrace6 = col_guess(),
                                                           dmar = col_guess(),
                                                           meduc = col_guess(),
                                                           fagerec11 = col_guess(),
                                                           frace6 = col_guess(),
                                                          feduc = col_guess(),
                                                          priorlive = col_guess(),
                                                          dplural = col_guess()))

head.matrix(nat2018us)
# nat2018us compte 2973577 observations
```

```{r}
nat2018us <- subset(nat2018us,(nat2018us$mrace6 != 6 & nat2018us$meduc != 9 & nat2018us$fagerec11 != 11 & nat2018us$frace6 != 9 & nat2018us$frace6 != 6 & nat2018us$feduc != 9 & nat2018us$apgar5r != 5 & nat2018us$priorlive != 99))
```


**Population cible**

```{r}
pop = subset(nat2018us,rf_inftr == "Y")
# il ne reste plus que 65921 observations
```



**Quelques statistiques descriptives**


```{r}
table(nat2018us$rf_inftr)
# 65921 ont recours à des traitements contre l'infertilité
round(table(nat2018us$rf_inftr)/length(nat2018us$rf_inftr),3)
# 2.2%

#parmi ceux qui ont eu recours à des traitements contre l'infertilité

table(pop$rf_fedrg)
# 27313 ont recours à des traitements contre l'infertilité sous forme de médicaments ou insémination artificielle
round(table(pop$rf_fedrg)/length(pop$rf_fedrg),3) # soit environ 41%

table(pop$rf_artec)
# 39589 sous forme d'assisted reproductive technology (ART) (IVF ou autres)
round(table(pop$rf_artec)/length(pop$rf_artec),3) # soit 60% 

# nombre d'enfant avant cette naissance 
round(table(pop$priorlive)/length(pop$priorlive),3)
# De plus, 56% n'ont pas eu d'enfant auparavant
```


**CARACTERISTIQUES DE LA POPULATION CIBLE**

**Age des parents**


Age de la mère : 
12 10 – 12 years
13 13 years
...
49 49 years
50 50 years and over

Age du père :
01 Under 15 years
02 15-19 years
03 20-24 years
04 25-29 years
05 30-34 years
06 35-39 years
07 40-44 years
08 45-49 years
09 50-54 years
10 55-98 years
11 Not stated

```{r}
summary(select(pop,mager))
summary(select(pop,fagerec11))
round(table(pop$fagerec11)/length(pop$fagerec11),3)
# 60% des pères sont âgés de 30 à 39 ans
```


```{r}
plot(density(pop$mager), lwd = 2, col = "orange", xlab = "", main = "âge de la mère à la naissance")
hist(pop$fagerec11, col = "cornflowerblue", xlab = "", main  = "âge du père à la naissance")
```

Les parents sont plus jeunes à la naissance de l'enfant sur la population entière

```{r}
summary(select(nat2018us,mager))
summary(select(nat2018us,fagerec11))
round(table(nat2018us$fagerec11)/length(nat2018us$fagerec11),3)
# environ 55% des pères sont âgés de 25 à 34 ans 
# Alors que sur la population entière les pères sont âgés de 30 à 34 ans en moyenne, sur la population cible ils sont âgés de 35 à 39 ans en moyenne
# l'écart est visible aussi pour les mères : 29-30 ans en moyenne / 34-35 ans chez la population cible
```

```{r}
plot(density(nat2018us$mager), lwd = 2, col = "orange", xlab = "", main = "âge de la mère à la naissance")
hist(nat2018us$fagerec11, col = "cornflowerblue", xlab = "", main  = "âge du père à la naissance")
```


**Ethnie des parents**

Race de la mère : 
1 White (only)
3 AIAN (American Indian or Alaskan Native) (only)
4 Asian (only)
5 NHOPI (Native Hawaiian or Other Pacific Islander) (only)
6 More than one race

Ethnie du père : 1.34, 75% blanc
1 White (only)
2 Black (only)
3 AIAN (only)
4 Asian (only)
5 NHOPI (only)
6 More than one race
9 Unknown or Not Stated

```{r}
summary(select(pop,mrace6))
summary(select(pop,frace6))
round(table(pop$frace6)/length(pop$frace6),3)
# 83 % des pères sont blancs, 11% asiatiques et 6% noirs
round(table(pop$mrace6)/length(pop$mrace6),3)
# taux similaires pour les mères
```

```{r}
hist(pop$frace6, col = "cornflowerblue", xlab = "", main  = "ethnie du père")
```


La part des pères blancs est toujours prédominante si on considère toute la population, mais elle l'est moins que chez la population cible et surtout la part des pères noirs est bien plus importante
```{r}
summary(select(nat2018us,mrace6))
summary(select(nat2018us,frace6))
round(table(nat2018us$frace6)/length(nat2018us$frace6),3)
# 77 % des pères sont blancs, 16% noirs et 7% asiatiques
round(table(nat2018us$mrace6)/length(nat2018us$mrace6),3)
```

```{r}
hist(nat2018us$frace6, col = "cornflowerblue", xlab = "", main  = "ethnie du père")
```

**Education des parents**
éducation de la mère : 
1 8th grade or less
2 9th through 12th grade with no diploma
3 High school graduate or GED completed
4 Some college credit, but not a degree.
5 Associate degree (AA,AS)
6 Bachelor’s degree (BA, AB, BS)
7 Master’s degree (MA, MS, MEng, MEd, MSW, MBA)
8 Doctorate (PhD, EdD) or Professional Degree (MD, DDS,DVM, LLB, JD)
9 Unknown

Education du père : 5.6, 
1 8th grade or less
2 9th through 12th grade with no diploma
3 High school graduate or GED completed
4 Some college credit, but not a degree.
5 Associate degree (AA,AS)
6 Bachelor’s degree (BA, AB, BS)
7 Master’s degree (MA, MS, MEng, MEd, MSW, MBA)
8 Doctorate (PhD, EdD) or Professional Degree (MD, DDS,DVM, LLB, JD)
9 Unknown


```{r}
summary(select(pop,meduc))
summary(select(pop,feduc))
round(table(pop$meduc)/length(pop$meduc),3)
round(table(pop$feduc)/length(pop$feduc),3)
```


```{r}
hist(pop$feduc, col = "cornflowerblue", xlab = "", main  = "niveau d'éducation du père")
hist(pop$meduc, col = "cornflowerblue", xlab = "", main  = "niveau d'éducation de la mère")
```

Sur la population entière, le niveau d'éducation des parents est bien moins élevé : en moyenne les parents qui ont recours au traitement ont un Bachelor’s degree, alors que toute la population considérée, ils ont "Some college credit, but not a degree".
L'écart se voit en particulier à la part de haut niveau d'éducation : plus de 20% des parents de la population cible ont un master ou un doctorat, tandis que sont plutôt 11% des parents en général.

```{r}
summary(select(nat2018us,meduc))
summary(select(nat2018us,feduc))
round(table(nat2018us$meduc)/length(nat2018us$meduc),3)
round(table(nat2018us$feduc)/length(nat2018us$feduc),3)
```


**Caractéristiques du couple**

Statut marital : 
1 Married
2 Unmarried

Enfant(s) encore en vie : 
00-30 Number of children still living from previous live births.
99 Unknown or not stated


```{r}
summary(select(pop,dmar))
summary(select(pop,priorlive))
summary(select(pop,dplural))
round(table(pop$dmar)/length(pop$dmar),3) # 87% sont mariés
round(table(pop$priorlive)/length(pop$priorlive),3) # 86% ont déjà au plus un enfant
round(table(pop$dplural)/length(pop$dplural),3) # 20% des mères ont donné naissance à des jumeaux
```

```{r}
hist(pop$priorlive, col = "cornflowerblue", xlab = "", main  = "nombre d'enfants")
box()
```

Moins de couples sont mariés et plus ont déjà eu des enfants auparavant mais surtout, beaucoup moins de naissance de jumeaux
```{r}
summary(select(nat2018us,dmar))
summary(select(nat2018us,priorlive))
summary(select(nat2018us,dplural))
round(table(nat2018us$dmar)/length(nat2018us$dmar),3) # 61% sont mariés
round(table(nat2018us$priorlive)/length(nat2018us$priorlive),3) # 38% n'ont pas eu d'enfant mais presque 30% ont déjà 2 enfants ou plus contre 12%
round(table(nat2018us$dplural)/length(nat2018us$dplural),3) # seul 3% des mères ont donné naissance à des jumeaux
```



**Santé de l'enfant**

Score Apgar : 3.76, 50% au moins 9
1 A score of 0-3
2 A score of 4-6
3 A score of 7-8
4 A score of 9-10
5 Unknown or not stated

Poids à la naissance :
0227-8165 Number of grams
9999 Not stated birth weight


```{r}
summary(select(pop,apgar5r))
summary(select(pop,dbwt))
```

```{r}
hist(pop$apgar5r, col = "cornflowerblue", xlab = "", main  = "Score Apgar")
```


```{r}
plot(density(pop$dbwt), lwd = 2, col = "orange", xlab = "", main = "poids à la naissance")
```


Le poids à la naissance est plus élevé en moyenne mais le score Apgard est comparable 
```{r}
summary(select(nat2018us,apgar5r))
summary(select(nat2018us,dbwt))
```

```{r}
hist(nat2018us$apgar5r, col = "cornflowerblue", xlab = "", main  = "Score Apgar")
```
```{r}
plot(density(nat2018us$dbwt), lwd = 2, col = "orange", xlab = "", main = "poids à la naissance")
```